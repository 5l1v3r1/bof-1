"""Boiboite simulator, just replies the appropriate response to a request."""

import socket
import sys

DescrReq = b"\x06\x10\x02\x03\x00\x0e\x08\x01\xc0\xa8\x00\x09\x86\x18"
DescrResp = b"\x06\x10\x02\x04\x00\x44\x36\x01\x02\x00\xff\xff\x00\x00\x00\x00" \
            b"\x54\xff\xf4\x13\xe0\x00\x17\x0c\x00\x00\x54\xff\xf4\x13\x73\x70" \
            b"\x61\x63\x65\x4c\x59\x6e\x6b\x00\x00\x00\x00\x00\x00\x00\x00\x00" \
            b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x02\x02\x01" \
            b"\x03\x01\x04\x01"
Config_ConnectReq = b"\x00\x00\x54\xff\xf4\x13\x84\x7b\xeb\x42\xb2\x04\x08\x00\x45\x00" \
                    b"\x00\x34\xe7\xdb\x40\x00\x40\x11\xd1\x79\xc0\xa8\x00\x09\xc0\xa8" \
                    b"\x00\x0a\xe7\x24\x0e\x57\x00\x20\x81\x95\x06\x10\x02\x05\x00\x18" \
                    b"\x08\x01\xc0\xa8\x00\x09\xe7\x24\x08\x01\xc0\xa8\x00\x09\xe7\x24" \
                    b"\x02\x03"
Config_ConnectResp = b"\x84\x7b\xeb\x42\xb2\x04\x00\x00\x54\xff\xf4\x13\x08\x00\x45\x00" \
                     b"\x00\x2e\x79\x8a\x40\x00\x40\x11\x3f\xd1\xc0\xa8\x00\x0a\xc0\xa8" \
                     b"\x00\x09\x0e\x57\xe7\x24\x00\x1a\xa6\xa4\x06\x10\x02\x06\x00\x12" \
                     b"\x01\x00\x08\x01\xc0\xa8\x00\x0a\x0e\x57\x02\x03"
ConfigReq = b"\x00\x00\x54\xff\xf4\x13\x84\x7b\xeb\x42\xb2\x04\x08\x00\x45\x00" \
            b"\x00\x2d\xe7\xdc\x40\x00\x40\x11\xd1\x7f\xc0\xa8\x00\x09\xc0\xa8" \
            b"\x00\x0a\xe7\x24\x0e\x57\x00\x19\x81\x8e\x06\x10\x03\x10\x00\x11" \
            b"\x04\x01\x00\x00\xfc\x00\x0b\x01\x35\x10\x00"
ConfigAck = b"\x84\x7b\xeb\x42\xb2\x04\x00\x00\x54\xff\xf4\x13\x08\x00\x45\x00" \
            b"\x00\x26\x79\x8b\x40\x00\x40\x11\x3f\xd8\xc0\xa8\x00\x0a\xc0\xa8" \
            b"\x00\x09\x0e\x57\xe7\x24\x00\x12\x7b\xbe\x06\x10\x03\x11\x00\x0a" \
            b"\x04\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

def do_boiboite_stuff(data):
    print(data)
    if data == DescrReq:
        return DescrResp
    if data == Config_ConnectReq:
        return Config_ConnectResp
    if data == ConfigReq:
        return ConfigAckResp
    # Else echo
    return data

sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
server_address = ('localhost', 13671)
sock.bind(server_address)

while True:
    data, address = sock.recvfrom(4096)
    if data:
        sock.sendto(do_boiboite_stuff(data), address)
